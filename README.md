# ETL-процедура для анализа качества и готовности BIM-моделей

Данный репозиторий содержит код, реализованный в рамках задачи по курсовой работе для магистратуры ВШЭ по направлению "Анализ данных в девелопменте", 1 курс. 

Тема курсовой работы: "Анализ качества и готовности информационных моделей зданий (BIM)".

ETL-процедура выведена в продакшен в ГК Самолет.

## Описание курсовой работы

В данной курсовой работе представлена и описана разработка ETL (Extract, Transform, Load) процедуры с использованием языка программирования Python, направленной на оптимизацию процесса анализа данных в контексте оценки качества проектирования BIM моделей. Разработанная ETL процедура осуществляет извлечение данных из базы данных и дополнительных источников, их преобразование и загрузку в результирующую таблицу в базе данных. Итоговая таблица содержит информацию по следующим показателям: дата, ID проекта, проектируемый раздел, количество ошибок в координатах, в уровнях, в Navisworks, в РН связях, в параметрах, а также процент корректности семейств. Исходные данные в базе данных обновляются еженедельно и ETL процедура запускается с такой же периодичностью. Итоговые данные из результирующей таблицы интегрированы в интерактивный аналитический BI отчет, что позволяет отслеживать и анализировать динамику изменения показателей качества проектирования BIM моделей.

## Описание файлов

### sql_query.py и excel_query.py
Эти файлы предназначены для загрузки данных из базы данных с использованием SQL-запросов и данных из Excel/txt файлов. Они содержат функции, выполняющие SQL-запросы для извлечения данных о проектах, файлах, элементах и параметрах, и функции для чтения и обработки справочных данных из Excel/txt файлов.

### transform.py
Файл transform.py предназначен для трансформации загруженных таблиц. Он содержит функции для преобразования таблиц, включая фильтрацию, объединение и вычисление новых столбцов.

### create_table.py
Файл create_table.py предназначен для создания новых таблиц на основе трансформированных данных. Он содержит функции для генерации новых таблиц, таких как уникальные параметры, координаты проекта и рабочие наборы и т. д.

### result.py
Файл result.py предназначен для вычисления и записи результатов проверок. Он содержит функции для подсчета ошибок, проверки корректности данных и формирования итоговой таблицы результатов.

### run.py
Файл run.py предназначен для последовательного выполнения всех функций и последующей загрузки таблицы result_table в базу данных. Он импортирует необходимые библиотеки и функции, устанавливает соединение с базой данных, загружает необходимые таблицы, выполняет трансформации данных, создает новые таблицы и записывает результаты проверок в базу данных.
